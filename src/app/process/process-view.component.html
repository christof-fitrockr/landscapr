<div class="container-fluid mt-4">

  <div class="d-flex justify-content-between align-items-center mb-4">
    <div class="btn-toolbar" role="toolbar">
      <app-process-edit-nav [processId]="processId"></app-process-edit-nav>
      <div class="btn-group shadow-sm mr-2">
        <button type="button" class="btn btn-outline-secondary" title="Download as PDF" (click)="downloadPdf()"><i class="fas fa-file-pdf"></i></button>
        <button type="button" class="btn btn-outline-secondary" title="Export to PPT" (click)="exportToPpt()"><i class="fas fa-file-powerpoint"></i></button>
      </div>
      <div class="btn-group shadow-sm mr-2">
        <button type="button" class="btn btn-outline-secondary" title="Zoom In" (click)="zoomIn()"><i class="fas fa-search-plus"></i></button>
        <button type="button" class="btn btn-outline-secondary" title="Zoom Out" (click)="zoomOut()"><i class="fas fa-search-minus"></i></button>
      </div>
      <div class="btn-group shadow-sm">
        <button type="button" class="btn btn-outline-secondary" title="Flow Tree View" (click)="toggleFlowView()" [class.active]="showFlowView"><i class="fas fa-sitemap"></i></button>
        <button type="button" class="btn btn-outline-secondary" title="Toggle Comments" (click)="showCommentsPanel = !showCommentsPanel" [class.active]="showCommentsPanel"><i class="fas fa-comments"></i></button>
        <button type="button" class="btn btn-outline-danger" title="Delete {{process?.name}}" (click)="delete()"><i class="fas fa-trash"></i></button>
      </div>
    </div>
    <div class="text-right">
      <h2 class="m-0 font-weight-bold text-uppercase text-gray-400">{{process?.name}}</h2>
      <div class="text-muted small">Process View</div>
    </div>
  </div>

  <div class="card shadow-sm border-0 mb-4 content">
    <div class="card-body p-0 m-0">


      <ng-container *ngIf="showFlowView">
        <app-process-flow-view [processId]="processId"></app-process-flow-view>
      </ng-container>

      <ng-container *ngIf="!showFlowView">
        <app-swimlane-view [zoomFactor]="zoomFactor" [processId]="processId"></app-swimlane-view>
      </ng-container>

    </div>

  </div>
</div>

<app-side-panel [isOpen]="panelOpen" [title]="panelTitle" (close)="closePanel()">
  <div *ngIf="selectedApi">
    <div class="mb-3">
      <label class="font-weight-bold small text-uppercase text-gray-500">Description</label>
      <div class="p-2 bg-light rounded border description-text">{{ selectedApi.description || 'No description' }}</div>
    </div>

    <div class="mb-3">
      <label class="font-weight-bold small text-uppercase text-gray-500">Input Data</label>
      <div class="p-2 bg-light rounded border">{{ selectedApi.input || 'No input data defined' }}</div>
    </div>

    <div class="mb-3">
      <label class="font-weight-bold small text-uppercase text-gray-500">Output Data</label>
      <div class="p-2 bg-light rounded border">{{ selectedApi.output || 'No output data defined' }}</div>
    </div>

    <div class="mb-3" *ngIf="selectedApiSystemName">
      <label class="font-weight-bold small text-uppercase text-gray-500">Implemented By</label>
      <div class="p-2 bg-light rounded border cursor-pointer hover-highlight" (click)="onSystemClick(selectedApi.implementedBy[0])" title="Click to view System details">
        <i class="fas fa-server mr-2"></i> {{ selectedApiSystemName }}
      </div>
    </div>
  </div>

  <div *ngIf="selectedSystem">
    <div class="mb-3">
      <label class="font-weight-bold small text-uppercase text-gray-500">Description</label>
      <div class="p-2 bg-light rounded border">{{ selectedSystem.description || 'No description' }}</div>
    </div>
    <div class="mb-3">
       <label class="font-weight-bold small text-uppercase text-gray-500">Contact</label>
       <div class="p-2 bg-light rounded border">{{ selectedSystem.contact || 'No contact info' }}</div>
    </div>
    <div class="mb-3">
       <label class="font-weight-bold small text-uppercase text-gray-500">URL</label>
       <div class="p-2 bg-light rounded border">
         <a *ngIf="selectedSystem.url" [href]="selectedSystem.url" target="_blank">{{ selectedSystem.url }}</a>
         <span *ngIf="!selectedSystem.url">No URL</span>
       </div>
    </div>
  </div>
</app-side-panel>

<app-comments-panel *ngIf="showCommentsPanel"
                    [comments]="process?.comments"
                    title="Process Comments"
                    (commentsChange)="updateProcessComments($event)"
                    (close)="showCommentsPanel = false">
</app-comments-panel>

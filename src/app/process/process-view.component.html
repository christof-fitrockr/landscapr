<div class="container-fluid">
  <div class="card mb-4 content">

    <div class="card-header py-3 d-flex flex-row align-items-center justify-content-between">

      <div class="btn-toolbar justify-content-lg-start" role="toolbar" aria-label="Toolbar with button groups">
        <app-process-edit-nav [processId]="processId"></app-process-edit-nav>
        <div class="btn-group mr-2" role="group" aria-label="First group">
          <button type="button" class="btn btn-secondary" title="Download as PDF" (click)="downloadPdf()"><i class="fas fa-file-pdf"></i></button>
          <button type="button" class="btn btn-secondary" title="Export to PPT" (click)="exportToPpt()"><i class="fas fa-file-powerpoint"></i></button>
          <button type="button" class="btn btn-secondary" title="Zoom In" (click)="zoomIn()"><i class="fas fa-search-plus"></i></button>
          <button type="button" class="btn btn-secondary" title="Zoom Out" (click)="zoomOut()"><i class="fas fa-search-minus"></i></button>
          <button type="button" class="btn btn-secondary" title="Flow Tree View" (click)="toggleFlowView()" [class.active]="showFlowView"><i class="fas fa-sitemap"></i></button>
          <button type="button" class="btn btn-secondary" title="Toggle Comments" (click)="showCommentsPanel = !showCommentsPanel" [class.active]="showCommentsPanel"><i class="fas fa-comments"></i></button>
          <button type="button" class="btn btn-danger" title="Delete {{process?.name}}" (click)="delete()"><i class="fas fa-trash"></i></button>

        </div>
      </div>

      <div class="btn-group justify-content-lg-end" role="group">
        <h3 class="m-0 font-weight-bold text-uppercase text-gray-400">Process View</h3>
      </div>

    </div>

    <div class="card-body p-0 m-0">


      <ng-container *ngIf="showFlowView">
        <app-process-flow-view [processId]="processId"></app-process-flow-view>
      </ng-container>

      <ng-container *ngIf="!showFlowView">
        <app-swimlane-view [zoomFactor]="zoomFactor" [processId]="processId"></app-swimlane-view>
      </ng-container>

    </div>

  </div>
</div>

<app-side-panel [isOpen]="panelOpen" [title]="panelTitle" (close)="closePanel()">
  <div *ngIf="selectedApi">
    <div class="mb-3">
      <label class="font-weight-bold small text-uppercase text-gray-500">Description</label>
      <div class="p-2 bg-light rounded border description-text">{{ selectedApi.description || 'No description' }}</div>
    </div>

    <div class="mb-3">
      <label class="font-weight-bold small text-uppercase text-gray-500">Input Data</label>
      <div class="p-2 bg-light rounded border">{{ selectedApi.input || 'No input data defined' }}</div>
    </div>

    <div class="mb-3">
      <label class="font-weight-bold small text-uppercase text-gray-500">Output Data</label>
      <div class="p-2 bg-light rounded border">{{ selectedApi.output || 'No output data defined' }}</div>
    </div>

    <div class="mb-3" *ngIf="selectedApiSystemName">
      <label class="font-weight-bold small text-uppercase text-gray-500">Implemented By</label>
      <div class="p-2 bg-light rounded border cursor-pointer hover-highlight" (click)="onSystemClick(selectedApi.implementedBy[0])" title="Click to view System details">
        <i class="fas fa-server mr-2"></i> {{ selectedApiSystemName }}
      </div>
    </div>
  </div>

  <div *ngIf="selectedSystem">
    <div class="mb-3">
      <label class="font-weight-bold small text-uppercase text-gray-500">Description</label>
      <div class="p-2 bg-light rounded border">{{ selectedSystem.description || 'No description' }}</div>
    </div>
    <div class="mb-3">
       <label class="font-weight-bold small text-uppercase text-gray-500">Contact</label>
       <div class="p-2 bg-light rounded border">{{ selectedSystem.contact || 'No contact info' }}</div>
    </div>
    <div class="mb-3">
       <label class="font-weight-bold small text-uppercase text-gray-500">URL</label>
       <div class="p-2 bg-light rounded border">
         <a *ngIf="selectedSystem.url" [href]="selectedSystem.url" target="_blank">{{ selectedSystem.url }}</a>
         <span *ngIf="!selectedSystem.url">No URL</span>
       </div>
    </div>
  </div>
</app-side-panel>

<app-comments-panel *ngIf="showCommentsPanel"
                    [comments]="process?.comments"
                    title="Process Comments"
                    (commentsChange)="updateProcessComments($event)"
                    (close)="showCommentsPanel = false">
</app-comments-panel>
